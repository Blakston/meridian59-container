const createConfig=(method,params)=>({method:method,headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify(params)});class Component{constructor(){this.state={}}emit(event,data){window.dispatchEvent(new CustomEvent(event,{detail:{output:data}}))}getState(key){return this.state[key]}on(event,fn){window.addEventListener(event,e=>{fn(e.detail.output)})}setState(key,val){this.state[key]=val}}class Model extends Component{constructor(){super(),this.on("Create",async params=>{let config=createConfig("POST",params);fetch("/api/accounts/create",config).then(response=>response.json()).then(data=>{this.emit("Create done",data)}).catch(err=>{this.emit("Create error",err)})}),this.on("Log",async params=>{let config=createConfig("POST",params);fetch("/api/god/log",config).then(response=>response.json()).then(data=>{this.emit("Log done",data)}).catch(err=>{this.emit("Log error",err)})}),this.on("Online",async params=>{let config=createConfig("POST",params);fetch("/api/accounts/online",config).then(response=>response.json()).then(data=>{this.emit("Online done",data)}).catch(err=>{this.emit("Online error",err)})})}}class ViewModel extends Component{constructor(){super(),this.on("Create done",data=>{this.setState("Create result",data)}),this.on("Log done",data=>{this.setState("Log result",data)}),this.on("Online done",data=>{this.setState("Online result",data)})}Create(data){this.emit("Create",data)}Log(data){this.emit("Log",data)}Show(data){this.emit("Online",data)}}class View extends Component{constructor(viewModel){super(),this.viewModel=viewModel,this.on("Create done",data=>{this.render()}),this.on("Create error",err=>{this.render()}),this.on("Log done",data=>{this.render()}),this.on("Log error",err=>{this.render()}),this.on("Online done",data=>{this.render()}),this.on("Online error",err=>{this.render()}),this.render()}render(){let create=this.viewModel.getState("Create result"),log=this.viewModel.getState("Log result"),online=this.viewModel.getState("Online result"),showStatus;void 0===create&&(create={error:""}),void 0===log&&(log=[]),void 0===online&&(online=[]),document.querySelector("#account_status").innerHTML=create.error;let showOnline=document.querySelector("#online");showOnline.innerHTML="";for(let i=0;i<online.length;i++){let p=document.createElement("p");p.innerText=online[i],showOnline.appendChild(p)}let showLog=document.querySelector("#logfile");showLog.innerHTML="";for(let i=0;i<log.length;i++){let p=document.createElement("p");p.innerText=log[i],showLog.appendChild(p)}let self=this;document.querySelector("#create").addEventListener("click",evt=>{evt.preventDefault(),self.viewModel.Create({user:document.querySelector("#user").value,pass:document.querySelector("#pass").value,pass2:document.querySelector("#pass2").value,email:document.querySelector("#email").value}),document.querySelector("#user").value="",document.querySelector("#pass").value="",document.querySelector("#pass2").value="",document.querySelector("#email").value=""}),reloadInterval||(reloadInterval=setInterval(()=>{self.viewModel.Log(),self.viewModel.Show()},1e4))}}let reloadInterval;const model=new Model,viewModel=new ViewModel,view=new View(viewModel);